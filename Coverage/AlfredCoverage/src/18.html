<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\alfred\alfred\matteland.ani.alfred.core.tests\chat\taghandlertests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// ---------------------------------------------------------
// ChatCommandTests.cs
// 
// Created on:      08/17/2015 at 9:56 PM
// Last Modified:   08/18/2015 at 3:04 PM
// 
// Last Modified by: Matt Eland
// ---------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Linq;

using JetBrains.Annotations;

using MattEland.Ani.Alfred.Chat.Aiml.Normalize;
using MattEland.Ani.Alfred.Chat.Aiml.TagHandlers;
using MattEland.Ani.Alfred.Chat.Aiml.Utils;
using MattEland.Ani.Alfred.Core.Modules.SysMonitor;
using MattEland.Common;

using NUnit.Framework;

namespace MattEland.Ani.Alfred.Tests.Chat
{
    /// &lt;summary&gt;
    ///     Tests for AimlTagHandlers of concern.
    /// &lt;/summary&gt;
    [TestFixture]
    public class TagHandlerTests : ChatTestsBase
    {
        /// &lt;summary&gt;
        ///     Sets up the testing environment prior to each test run.
        /// &lt;/summary&gt;
        [SetUp]
        public void SetUp()
        {
            InitChatSystem();
        }

        /// &lt;summary&gt;
        ///     Tests that random tags with no children return empty results.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     See ALF-29
        /// &lt;/remarks&gt;
        [Test]
        public void RandomTagWithNoChildrenReturnsEmpty()
        {
            // Build a handler to test with
            var handler = BuildTagHandler&lt;RandomTagHandler&gt;(&quot;random&quot;, &quot;&lt;random /&gt;&quot;);

            // Ensure that the results are what we expect
            var result = handler.Transform();
            Assert.That(result.IsEmpty(), $&quot;Tag Handler result of &#39;{result}&#39; was not empty as expected.&quot;);
        }

        /// &lt;summary&gt;
        ///     Tests that random tags with unexpected children return empty results.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     See ALF-29
        /// &lt;/remarks&gt;
        [Test]
        public void RandomTagWithWrongChildTypeReturnsEmpty()
        {
            // Build a handler to test with
            var handler = BuildTagHandler&lt;RandomTagHandler&gt;(&quot;random&quot;, &quot;&lt;random&gt;&lt;b&gt;Dude&lt;/b&gt;&lt;b&gt;Bro&lt;/b&gt;&lt;/random&gt;&quot;);

            // Ensure that the results are what we expect
            var result = handler.Transform();
            Assert.That(result.IsEmpty(), $&quot;Tag Handler result of &#39;{result}&#39; was not empty as expected.&quot;);
        }

        [Test]
        public void TextSubstitutionHelperWithNullSettingsReturnsInput()
        {
            var input = &quot;foo&quot;;
            var output = TextSubstitutionHelper.Substitute(null, input);

            Assert.AreEqual(input, output);
        }

        [Test]
        public void TextSubstitutionHelperWithNullInputReturnsEmpty()
        {
            var output = TextSubstitutionHelper.Substitute(null, null);

            Assert.IsNotNull(output);
            Assert.That(output.IsEmpty());
        }

        [Test]
        public void TextSubstitutionHelperSubstitutesText()
        {
            var subs = new SettingsManager();
            subs.Add(&quot;Foo&quot;, &quot;Bar&quot;);
            var output = TextSubstitutionHelper.Substitute(subs, &quot;Foo&quot;);

            Assert.AreEqual(&quot;Bar&quot;, output);
        }

        [Test]
        public void TextSubstitutionHelperHandlesEmptyEntries()
        {
            var subs = new SettingsManager();
            subs.Add(&quot;Foo&quot;, &quot;Bar&quot;);
            subs.Add(&quot;Frodo&quot;, null);

            var input = &quot;Baggins&quot;;
            var output = TextSubstitutionHelper.Substitute(subs, input);

            Assert.AreEqual(input, output);
        }

        [Test]
        public void TextSubstitutionHelperHandlesNullInput()
        {
            var output = TextSubstitutionHelper.Substitute(null, &quot;Bubba&quot;, &quot;Gump&quot;);

            Assert.IsNotNull(output);
            Assert.That(output.IsEmpty());
        }

        [Test]
        public void TextSubstitutionHelperHandlesReplacement()
        {
            var output = TextSubstitutionHelper.Substitute(&quot;Bubbark Shrimp ZeBubba Bubbazar Bubba Gump&quot;, &quot;Bubba&quot;, &quot;Gump&quot;);

            Assert.AreEqual(&quot;Bubbark Shrimp ZeBubba Bubbazar Gump Gump&quot;, output);
        }

    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[37,9,37,10,1],[38,13,38,30,1],[39,9,39,10,1],[49,9,49,10,1],[51,13,51,85,1],[54,13,54,46,1],[55,13,55,107,1],[56,9,56,10,1],[66,9,66,10,1],[68,13,68,113,1],[71,13,71,46,1],[72,13,72,107,1],[73,9,73,10,1],[77,9,77,10,1],[78,13,78,31,1],[79,13,79,73,1],[81,13,81,44,1],[82,9,82,10,1],[86,9,86,10,1],[87,13,87,72,1],[89,13,89,38,1],[90,13,90,43,1],[91,9,91,10,1],[95,9,95,10,1],[96,13,96,46,1],[97,13,97,36,1],[98,13,98,73,1],[100,13,100,44,1],[101,9,101,10,1],[105,9,105,10,1],[106,13,106,46,1],[107,13,107,36,1],[108,13,108,37,1],[110,13,110,35,1],[111,13,111,73,1],[113,13,113,44,1],[114,9,114,10,1],[118,9,118,10,1],[119,13,119,83,1],[121,13,121,38,1],[122,13,122,43,1],[123,9,123,10,1],[127,9,127,10,1],[128,13,128,123,1],[130,13,130,82,1],[131,9,131,10,1]]);
    </script>
  </body>
</html>