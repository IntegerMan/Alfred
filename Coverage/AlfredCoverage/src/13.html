<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\alfred\alfred\matteland.ani.alfred.core.tests\mocks\testsubsystem.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// ---------------------------------------------------------
// TestSubsystem.cs
// 
// Created on:      08/07/2015 at 11:07 PM
// Last Modified:   08/08/2015 at 1:43 AM
// Original author: Matt Eland
// ---------------------------------------------------------

using System;
using System.Collections.Generic;

using JetBrains.Annotations;

using MattEland.Ani.Alfred.Core;
using MattEland.Ani.Alfred.Core.Definitions;
using MattEland.Ani.Alfred.Core.Pages;

namespace MattEland.Ani.Alfred.Tests.Mocks
{
    public class TestSubsystem : AlfredSubsystem
    {
        [NotNull, ItemNotNull]
        private readonly ICollection&lt;AlfredPage&gt; _registerPages;

        /// &lt;summary&gt;
        ///     Initializes a new instance of the &lt;see cref=&quot;AlfredSubsystem&quot; /&gt; class.
        /// &lt;/summary&gt;
        public TestSubsystem() : this(new SimplePlatformProvider())
        {
        }

        public TestSubsystem([NotNull] IPlatformProvider provider) : base(provider)
        {
            if (provider == null)
            {
                throw new ArgumentNullException(nameof(provider));
            }

            _registerPages = provider.CreateCollection&lt;AlfredPage&gt;();
        }

        /// &lt;summary&gt;
        ///     Gets the name of the subsystems.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The name.&lt;/value&gt;
        public override string Name
        {
            get { return &quot;Test SubSystem&quot;; }
        }

        /// &lt;summary&gt;
        /// Registers the controls for this component.
        /// &lt;/summary&gt;
        protected override void RegisterControls()
        {
            // Live up to our promise and auto-register some pages
            foreach (var page in _registerPages)
            {
                Register(page);
            }
        }

        /// &lt;summary&gt;
        ///     Gets or sets the last time this module was updated.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The last time the module was updated.&lt;/value&gt;
        public DateTime LastUpdated { get; set; }

        public DateTime LastInitializationCompleted { get; set; }

        /// &lt;summary&gt;
        ///     Gets or sets the last shutdown completed time.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The last shutdown completed time.&lt;/value&gt;
        public DateTime LastShutdownCompleted { get; set; }

        /// &lt;summary&gt;
        ///     Gets or sets the last shutdown time.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The last shutdown time.&lt;/value&gt;
        public DateTime LastShutdown { get; set; }

        /// &lt;summary&gt;
        ///     Gets or sets the last initialized time.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The last initialized time.&lt;/value&gt;
        public DateTime LastInitialized { get; set; }

        /// &lt;summary&gt;
        ///     A notification method that is invoked when initialization for Alfred is complete so the UI can be fully enabled or
        ///     adjusted
        /// &lt;/summary&gt;
        public override void OnInitializationCompleted()
        {
            LastInitializationCompleted = DateTime.Now;

            base.OnInitializationCompleted();
        }

        /// &lt;summary&gt;
        ///     A notification method that is invoked when shutdown for Alfred is complete so the UI can be fully enabled or
        ///     adjusted
        /// &lt;/summary&gt;
        public override void OnShutdownCompleted()
        {
            LastShutdownCompleted = DateTime.Now;

            base.OnShutdownCompleted();
        }

        /// &lt;summary&gt;
        ///     Handles shutdown events
        /// &lt;/summary&gt;
        protected override void ShutdownProtected()
        {
            LastShutdown = DateTime.Now;

            base.ShutdownProtected();
        }

        /// &lt;summary&gt;
        ///     Handles initialization events
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;alfred&quot;&gt;&lt;/param&gt;
        protected override void InitializeProtected(IAlfred alfred)
        {
            LastInitialized = DateTime.Now;

            base.InitializeProtected(alfred);
        }

        /// &lt;summary&gt;
        ///     Handles updating the component as needed
        /// &lt;/summary&gt;
        protected override void UpdateProtected()
        {
            LastUpdated = DateTime.Now;

            base.UpdateProtected();
        }

        /// &lt;summary&gt;
        /// Adds a page to be automatically registered on initialization
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;page&quot;&gt;The page.&lt;/param&gt;
        public void AddAutoRegisterPage([NotNull] AlfredPage page)
        {
            if (page == null)
            {
                throw new ArgumentNullException(nameof(page));
            }

            _registerPages.Add(page);
        }

        /// &lt;summary&gt;
        ///     Gets the identifier for the subsystem to be used in command routing.
        /// &lt;/summary&gt;
        /// &lt;value&gt;The identifier for the subsystem.&lt;/value&gt;
        public override string Id
        {
            get { return &quot;Test&quot;; }
        }
    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[35,13,35,14,0],[36,17,36,67,0],[149,13,149,14,0],[150,17,150,63,0],[162,17,162,18,0],[162,19,162,33,0],[162,34,162,35,0],[28,34,28,68,1],[29,9,29,10,1],[30,9,30,10,1],[32,70,32,84,1],[33,9,33,10,1],[34,13,34,34,1],[39,13,39,70,1],[40,9,40,10,1],[48,17,48,18,1],[48,19,48,43,1],[48,44,48,45,1],[55,9,55,10,1],[57,13,57,20,1],[57,34,57,48,1],[57,22,57,30,1],[58,13,58,14,1],[59,17,59,32,1],[60,13,60,14,1],[57,31,57,33,1],[61,9,61,10,1],[67,39,67,43,1],[67,44,67,48,1],[69,55,69,59,1],[69,60,69,64,1],[75,49,75,53,1],[75,54,75,58,1],[81,40,81,44,1],[81,45,81,49,1],[87,43,87,47,1],[87,48,87,52,1],[94,9,94,10,1],[95,13,95,56,1],[97,13,97,46,1],[98,9,98,10,1],[105,9,105,10,1],[106,13,106,50,1],[108,13,108,40,1],[109,9,109,10,1],[115,9,115,10,1],[116,13,116,41,1],[118,13,118,38,1],[119,9,119,10,1],[126,9,126,10,1],[127,13,127,44,1],[129,13,129,46,1],[130,9,130,10,1],[136,9,136,10,1],[137,13,137,40,1],[139,13,139,36,1],[140,9,140,10,1],[147,9,147,10,1],[148,13,148,30,1],[153,13,153,38,1],[154,9,154,10,1]]);
    </script>
  </body>
</html>