<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\alfred\matteland.ani.alfred.core.tests\chat\taghandlertests.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// ---------------------------------------------------------
// ChatCommandTests.cs
// 
// Created on:      08/17/2015 at 9:56 PM
// Last Modified:   08/18/2015 at 3:04 PM
// 
// Last Modified by: Matt Eland
// ---------------------------------------------------------

using System;
using System.Collections.Generic;
using System.Linq;

using JetBrains.Annotations;

using MattEland.Ani.Alfred.Chat.Aiml.TagHandlers;
using MattEland.Ani.Alfred.Chat.Aiml.Utils;
using MattEland.Ani.Alfred.Core.Modules.SysMonitor;
using MattEland.Common;

using NUnit.Framework;

namespace MattEland.Ani.Alfred.Tests.Chat
{
    /// &lt;summary&gt;
    ///     Tests for AimlTagHandlers of concern.
    /// &lt;/summary&gt;
    [TestFixture]
    public class TagHandlerTests : ChatTestsBase
    {
        /// &lt;summary&gt;
        ///     Sets up the testing environment prior to each test run.
        /// &lt;/summary&gt;
        [SetUp]
        public void SetUp()
        {
            InitChatSystem();
        }

        /// &lt;summary&gt;
        ///     Tests that random tags with no children return empty results.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     See ALF-29
        /// &lt;/remarks&gt;
        [Test]
        public void RandomTagWithNoChildrenReturnsEmpty()
        {
            // Build a handler to test with
            var handler = BuildTagHandler&lt;RandomTagHandler&gt;(&quot;random&quot;, &quot;&lt;random /&gt;&quot;);

            // Ensure that the results are what we expect
            var result = handler.Transform();
            Assert.That(result.IsEmpty(), $&quot;Tag Handler result of &#39;{result}&#39; was not empty as expected.&quot;);
        }

        /// &lt;summary&gt;
        ///     Tests that random tags with unexpected children return empty results.
        /// &lt;/summary&gt;
        /// &lt;remarks&gt;
        ///     See ALF-29
        /// &lt;/remarks&gt;
        [Test]
        public void RandomTagWithWrongChildTypeReturnsEmpty()
        {
            // Build a handler to test with
            var handler = BuildTagHandler&lt;RandomTagHandler&gt;(&quot;random&quot;, &quot;&lt;random&gt;&lt;b&gt;Dude&lt;/b&gt;&lt;b&gt;Bro&lt;/b&gt;&lt;/random&gt;&quot;);

            // Ensure that the results are what we expect
            var result = handler.Transform();
            Assert.That(result.IsEmpty(), $&quot;Tag Handler result of &#39;{result}&#39; was not empty as expected.&quot;);
        }

        [Test]
        public void TextSubstitutionHelperWithNullSettingsReturnsInput()
        {
            var input = &quot;foo&quot;;
            var output = TextSubstitutionHelper.Substitute(null, input);

            Assert.AreEqual(input, output);
        }

        [Test]
        public void TextSubstitutionHelperWithNullInputReturnsEmpty()
        {
            var output = TextSubstitutionHelper.Substitute(null, null);

            Assert.IsNotNull(output);
            Assert.That(output.IsEmpty());
        }

        [Test]
        public void TextSubstitutionHelperSubstitutesText()
        {
            var subs = new SettingsManager();
            subs.Add(&quot;Foo&quot;, &quot;Bar&quot;);
            var output = TextSubstitutionHelper.Substitute(subs, &quot;Foo&quot;);

            Assert.AreEqual(&quot;Bar&quot;, output);
        }

        [Test]
        public void TextSubstitutionHelperHandlesEmptyEntries()
        {
            var subs = new SettingsManager();
            subs.Add(&quot;Foo&quot;, &quot;Bar&quot;);
            subs.Add(&quot;Frodo&quot;, null);

            var input = &quot;Baggins&quot;;
            var output = TextSubstitutionHelper.Substitute(subs, input);

            Assert.AreEqual(input, output);
        }

        [Test]
        public void TextSubstitutionHelperHandlesNullInput()
        {
            var output = TextSubstitutionHelper.Substitute(null, &quot;Bubba&quot;, &quot;Gump&quot;);

            Assert.IsNotNull(output);
            Assert.That(output.IsEmpty());
        }

        [Test]
        public void TextSubstitutionHelperHandlesReplacement()
        {
            var output = TextSubstitutionHelper.Substitute(&quot;Bubbark Shrimp ZeBubba Bubbazar Bubba Gump&quot;, &quot;Bubba&quot;, &quot;Gump&quot;);

            Assert.AreEqual(&quot;Bubbark Shrimp ZeBubba Bubbazar Gump Gump&quot;, output);
        }

    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[36,9,36,10,1],[37,13,37,30,1],[38,9,38,10,1],[48,9,48,10,1],[50,13,50,85,1],[53,13,53,46,1],[54,13,54,107,1],[55,9,55,10,1],[65,9,65,10,1],[67,13,67,113,1],[70,13,70,46,1],[71,13,71,107,1],[72,9,72,10,1],[76,9,76,10,1],[77,13,77,31,1],[78,13,78,73,1],[80,13,80,44,1],[81,9,81,10,1],[85,9,85,10,1],[86,13,86,72,1],[88,13,88,38,1],[89,13,89,43,1],[90,9,90,10,1],[94,9,94,10,1],[95,13,95,46,1],[96,13,96,36,1],[97,13,97,73,1],[99,13,99,44,1],[100,9,100,10,1],[104,9,104,10,1],[105,13,105,46,1],[106,13,106,36,1],[107,13,107,37,1],[109,13,109,35,1],[110,13,110,73,1],[112,13,112,44,1],[113,9,113,10,1],[117,9,117,10,1],[118,13,118,83,1],[120,13,120,38,1],[121,13,121,43,1],[122,9,122,10,1],[126,9,126,10,1],[127,13,127,123,1],[129,13,129,82,1],[130,9,130,10,1]]);
    </script>
  </body>
</html>