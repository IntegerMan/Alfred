<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <title>c:\dev\alfred\matteland.common\stringextensions.cs</title>
    <script type="text/javascript" src="../js/dotcover.sourceview.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/dotcover.report.css" />
  </head>
  <body>
    <pre id="content" class="source-code">
// ---------------------------------------------------------
// StringExtensions.cs
// 
// Created on:      08/12/2015 at 2:12 PM
// Last Modified:   08/14/2015 at 11:26 PM
// 
// Last Modified by: Matt Eland
// ---------------------------------------------------------

using System;
using System.Text;

using JetBrains.Annotations;

namespace MattEland.Common
{
    /// &lt;summary&gt;
    ///     Contains extension methods dealing with string operations.
    /// &lt;/summary&gt;
    public static class StringExtensions
    {
        /// &lt;summary&gt;
        ///     Determines if the input string is has text (is not null and has text beyond whitespace).
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the string has text; otherwise, &lt;c&gt;false&lt;/c&gt;.&lt;/returns&gt;
        [UsedImplicitly]
        public static bool HasText([CanBeNull] this string input)
        {
            return !input.IsNullOrWhitespace();
        }

        /// &lt;summary&gt;
        ///     Determines if the input string is null or an empty string.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the string is null or empty; otherwise, &lt;c&gt;false&lt;/c&gt;.&lt;/returns&gt;
        [UsedImplicitly]
        public static bool IsEmpty([CanBeNull] this string input)
        {
            return string.IsNullOrEmpty(input);
        }

        /// &lt;summary&gt;
        ///     Determines if the input string is null, an empty string, or whitespace.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the string is null or whitespace; otherwise, &lt;c&gt;false&lt;/c&gt;.&lt;/returns&gt;
        [UsedImplicitly]
        public static bool IsNullOrWhitespace([CanBeNull] this string input)
        {
            return string.IsNullOrWhiteSpace(input);
        }

        /// &lt;summary&gt;
        ///     Ensures that the passed in string is not null and returns either the input string or
        ///     string.empty.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;returns&gt;A sanitized string&lt;/returns&gt;
        [NotNull]
        public static string NonNull([CanBeNull] this string input)
        {
            return input ?? string.Empty;
        }

        /// &lt;summary&gt;
        ///     Ensures that the passed in string is not null and returns either the input string or
        ///     replacement.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;param name=&quot;replacement&quot;&gt;The replacement string when input is null.&lt;/param&gt;
        /// &lt;returns&gt;A sanitized string&lt;/returns&gt;
        /// &lt;exception cref=&quot;ArgumentNullException&quot;&gt;&lt;paramref name=&quot;replacement&quot; /&gt; is &lt;see langword=&quot;null&quot; /&gt;.&lt;/exception&gt;
        [NotNull]
        public static string IfNull([CanBeNull] this string input, [NotNull] string replacement)
        {
            if (replacement == null)
            {
                throw new ArgumentNullException(nameof(replacement));
            }

            return input ?? replacement;
        }

        /// &lt;summary&gt;
        ///     Extension method to compare two strings and return true if they&#39;re equal according to the
        ///     comparison type used. By default strings are compared ordinally ignoring casing.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;param name=&quot;other&quot;&gt;The other string.&lt;/param&gt;
        /// &lt;param name=&quot;comparison&quot;&gt;The comparison type. Defaults to ordinal ignoring case.&lt;/param&gt;
        /// &lt;returns&gt;&lt;c&gt;true&lt;/c&gt; if the strings are equal, &lt;c&gt;false&lt;/c&gt; otherwise.&lt;/returns&gt;
        public static bool Matches([CanBeNull] this string input,
                                   [CanBeNull] string other,
                                   StringComparison comparison = StringComparison.OrdinalIgnoreCase)
        {
            return string.Compare(input, other, comparison) == 0;
        }

        /// &lt;summary&gt;
        /// Converts the input string to an integer, falling back to the fallback value on parse error.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;param name=&quot;fallbackValue&quot;&gt;The fallback value. Defaults to 0.&lt;/param&gt;
        /// &lt;returns&gt;The parsed value or the fallback value in case of parse error.&lt;/returns&gt;
        public static int AsInt(this string input, int fallbackValue = 0)
        {
            int output;

            // Safely cast the input as an integer. Failure will not throw an exception
            if (!int.TryParse(input?.Trim(), out output))
            {
                // In case of failure, use our fallback value
                output = fallbackValue;
            }

            return output;
        }

        /// &lt;summary&gt;
        /// Converts the input string to a double, falling back to the fallback value on parse error.
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;input&quot;&gt;The input string.&lt;/param&gt;
        /// &lt;param name=&quot;fallbackValue&quot;&gt;The fallback value. Defaults to 0.&lt;/param&gt;
        /// &lt;returns&gt;The parsed value or the fallback value in case of parse error.&lt;/returns&gt;
        public static double AsDouble(this string input, double fallbackValue = 0)
        {
            double output;

            // Safely cast the input as an integer. Failure will not throw an exception
            if (!double.TryParse(input?.Trim(), out output))
            {
                // In case of failure, use our fallback value
                output = fallbackValue;
            }

            return output;
        }

        /// &lt;summary&gt;
        /// Appends to a string builder either as a standard append or as an AppendLine, depending on useNewLine
        /// &lt;/summary&gt;
        /// &lt;param name=&quot;stringBuilder&quot;&gt;The string builder.&lt;/param&gt;
        /// &lt;param name=&quot;message&quot;&gt;The message.&lt;/param&gt;
        /// &lt;param name=&quot;useNewLine&quot;&gt;Whether or not to include line breaks.&lt;/param&gt;
        public static void AppendConditional([NotNull] this StringBuilder stringBuilder, string message, bool useNewLine)
        {
            if (useNewLine)
            {
                stringBuilder.AppendLine(message);
            }
            else
            {
                stringBuilder.Append(message);
            }

        }

    }
}
    </pre>
    <script type="text/javascript">
      highlightRanges([[77,9,77,10,0],[78,13,78,37,0],[79,13,79,14,0],[80,17,80,70,0],[83,13,83,41,0],[84,9,84,10,0],[108,9,108,10,0],[112,13,112,58,0],[113,13,113,14,0],[115,17,115,40,0],[116,13,116,14,0],[118,13,118,27,0],[119,9,119,10,0],[128,9,128,10,0],[132,13,132,61,0],[133,13,133,14,0],[135,17,135,40,0],[136,13,136,14,0],[138,13,138,27,0],[139,9,139,10,0],[148,9,148,10,0],[149,13,149,28,0],[150,13,150,14,0],[151,17,151,51,0],[152,13,152,14,0],[154,13,154,14,0],[155,17,155,47,0],[156,13,156,14,0],[158,9,158,10,0],[29,9,29,10,1],[30,13,30,48,1],[31,9,31,10,1],[40,9,40,10,1],[41,13,41,48,1],[42,9,42,10,1],[51,9,51,10,1],[52,13,52,53,1],[53,9,53,10,1],[63,9,63,10,1],[64,13,64,42,1],[65,9,65,10,1],[97,9,97,10,1],[98,13,98,66,1],[99,9,99,10,1]]);
    </script>
  </body>
</html>